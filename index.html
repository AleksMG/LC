<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Double Vigenère Cipher</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .container {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            padding: 30px;
            width: 100%;
            max-width: 1200px;
            margin: 20px 0;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            color: #00ffcc;
            text-shadow: 0 0 15px rgba(0, 255, 204, 0.7);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #ddd;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .security-badge {
            display: inline-block;
            background: linear-gradient(to right, #4CAF50, #2E8B57);
            color: white;
            padding: 8px 20px;
            border-radius: 30px;
            margin-top: 15px;
            font-weight: bold;
            font-size: 1rem;
        }
        
        .card {
            background: rgba(30, 30, 50, 0.7);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(100, 100, 150, 0.5);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .card-title {
            color: #4dccbd;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .card-title i {
            font-size: 1.5rem;
            color: #00ffcc;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            color: #aaa;
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px 18px;
            border-radius: 10px;
            border: 2px solid #444;
            background: rgba(10, 10, 20, 0.7);
            color: #fff;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #00ffcc;
            box-shadow: 0 0 15px rgba(0, 255, 204, 0.5);
        }
        
        .input-hint {
            font-size: 0.9rem;
            color: #888;
            margin-top: 5px;
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        button {
            flex: 1;
            min-width: 150px;
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .encrypt-btn {
            background: linear-gradient(to right, #4CAF50, #2E8B57);
            color: white;
        }
        
        .decrypt-btn {
            background: linear-gradient(to right, #f44336, #B22222);
            color: white;
        }
        
        .reset-btn {
            background: linear-gradient(to right, #2196F3, #0D47A1);
            color: white;
        }
        
        .test-btn {
            background: linear-gradient(to right, #FF9800, #E65100);
            color: white;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .result-container {
            background: rgba(30, 50, 30, 0.7);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }
        
        .result-text {
            font-size: 1.5rem;
            text-align: center;
            padding: 25px;
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            font-family: monospace;
            letter-spacing: 2px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            word-break: break-all;
            border: 2px dashed #4dccbd;
            line-height: 1.6;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #888;
        }
        
        .status-ok {
            background: #4CAF50;
        }
        
        .status-error {
            background: #f44336;
        }
        
        .crypto-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .info-card {
            background: rgba(20, 20, 40, 0.8);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .info-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00ffcc;
            margin: 10px 0;
        }
        
        .info-label {
            color: #aaa;
            font-size: 1rem;
        }
        
        .verification-panel {
            background: rgba(50, 50, 80, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .verification-result {
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .success {
            background: rgba(76, 175, 80, 0.2);
            color: #4CAF50;
            border: 1px solid #4CAF50;
        }
        
        .error {
            background: rgba(244, 67, 54, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        footer {
            text-align: center;
            margin-top: 30px;
            color: #aaa;
            padding: 20px;
            width: 100%;
            font-size: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
            
            .crypto-info {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-double-layer"></i> Advanced Double Vigenère Cipher</h1>
            <p class="subtitle">Double-layer encryption with enhanced security and integrity verification</p>
            <div class="security-badge">
                <i class="fas fa-shield-alt"></i> 2<sup>112</sup> BIT SECURITY WITH 12-CHAR KEYS
            </div>
        </header>
        
        <div class="card">
            <div class="card-title">
                <i class="fas fa-key"></i>
                <span>Encryption Keys</span>
            </div>
            
            <div class="input-group">
                <label for="key1"><i class="fas fa-key"></i> First Layer Key (A-Z only)</label>
                <input type="text" id="key1" placeholder="Enter first encryption key" value="SECRETKEYONE">
                <div class="input-hint">Used for the first Vigenère encryption layer</div>
            </div>
            
            <div class="input-group">
                <label for="key2"><i class="fas fa-key"></i> Second Layer Key (A-Z only)</label>
                <input type="text" id="key2" placeholder="Enter second encryption key" value="SECRETKEYTWO">
                <div class="input-hint">Used for the second mapping encryption layer</div>
            </div>
            
            <div class="input-group">
                <label for="inputText"><i class="fas fa-keyboard"></i> Input Text</label>
                <textarea id="inputText" rows="4" placeholder="Enter text to encrypt or decrypt">Confidential data: Operation Midnight at 23:59</textarea>
            </div>
            
            <div class="btn-group">
                <button class="encrypt-btn" onclick="encrypt()">
                    <i class="fas fa-lock"></i> Encrypt
                </button>
                <button class="decrypt-btn" onclick="decrypt()">
                    <i class="fas fa-lock-open"></i> Decrypt
                </button>
                <button class="test-btn" onclick="testIntegrity()">
                    <i class="fas fa-check-circle"></i> Test Integrity
                </button>
                <button class="reset-btn" onclick="resetAll()">
                    <i class="fas fa-redo"></i> Reset
                </button>
            </div>
            
            <div class="status-indicator">
                <div class="status-dot" id="keyStatus"></div>
                <span id="keyStatusText">Keys not validated</span>
            </div>
        </div>
        
        <div class="crypto-info">
            <div class="info-card">
                <div class="info-label">Key Space Size</div>
                <div class="info-value" id="keySpace">0</div>
                <div class="info-label">Possible combinations</div>
            </div>
            
            <div class="info-card">
                <div class="info-label">Brute Force Time</div>
                <div class="info-value" id="bruteForceTime">0</div>
                <div class="info-label">At 1 trillion ops/sec</div>
            </div>
            
            <div class="info-card">
                <div class="info-label">Security Level</div>
                <div class="info-value" id="securityLevel">0-bit</div>
                <div class="info-label">Equivalent protection</div>
            </div>
        </div>
        
        <div class="result-container">
            <div class="card-title">
                <i class="fas fa-terminal"></i>
                <span>Output Result</span>
            </div>
            <div class="result-text" id="outputText">
                Your encrypted/decrypted text will appear here
            </div>
            
            <div class="verification-panel">
                <div class="card-title">
                    <i class="fas fa-fingerprint"></i>
                    <span>Integrity Verification</span>
                </div>
                <div class="verification-result" id="verificationResult">
                    No verification performed yet
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <p>Advanced Double Vigenère Cipher | Dual-layer encryption with enhanced security</p>
        <p>This implementation provides 2<sup>112</sup> bit security with 12-character keys</p>
    </footer>

    <script>
        // Configuration
        const ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
        const SYMBOLS = "AMNOPISTUVⴽXYZ×+ꓘꓥꓭꓷ⊕ΞΔ⌖#ⵁ";
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            validateKeys();
            updateSecurityStats();
            
            // Add input validation
            document.getElementById('key1').addEventListener('input', function() {
                this.value = this.value.toUpperCase().replace(/[^A-Z]/g, '');
                validateKeys();
                updateSecurityStats();
            });
            
            document.getElementById('key2').addEventListener('input', function() {
                this.value = this.value.toUpperCase().replace(/[^A-Z]/g, '');
                validateKeys();
                updateSecurityStats();
            });
        });
        
        // Validate keys
        function validateKeys() {
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            const statusDot = document.getElementById('keyStatus');
            const statusText = document.getElementById('keyStatusText');
            
            if (key1.length === 0 || key2.length === 0) {
                statusDot.className = 'status-dot status-error';
                statusText.textContent = 'Error: Keys cannot be empty';
                return false;
            }
            
            if (key1.length < 6 || key2.length < 6) {
                statusDot.className = 'status-dot status-error';
                statusText.textContent = 'Warning: Keys should be at least 6 characters for security';
                return false;
            }
            
            statusDot.className = 'status-dot status-ok';
            statusText.textContent = 'Keys validated: ' + key1.length + ' + ' + key2.length + ' characters';
            return true;
        }
        
        // Update security statistics
        function updateSecurityStats() {
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            
            // Key space calculation
            const keySpace = Math.pow(26, key1.length) * Math.pow(26, key2.length);
            document.getElementById('keySpace').textContent = keySpace.toExponential(2);
            
            // Brute force time estimation (at 1 trillion operations per second)
            const seconds = keySpace / 1e12;
            const years = seconds / (60 * 60 * 24 * 365.25);
            
            if (years > 1e9) {
                document.getElementById('bruteForceTime').textContent = (years / 1e9).toFixed(1) + 'B years';
            } else if (years > 1e6) {
                document.getElementById('bruteForceTime').textContent = (years / 1e6).toFixed(1) + 'M years';
            } else if (years > 1e3) {
                document.getElementById('bruteForceTime').textContent = (years / 1e3).toFixed(1) + 'K years';
            } else {
                document.getElementById('bruteForceTime').textContent = years.toFixed(1) + ' years';
            }
            
            // Security level (log2 of key space)
            const securityLevel = Math.log2(keySpace);
            document.getElementById('securityLevel').textContent = Math.round(securityLevel) + '-bit';
        }
        
        // Encrypt text
        function encrypt() {
            if (!validateKeys()) return;
            
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            const inputText = document.getElementById('inputText').value.toUpperCase();
            
            try {
                // First layer: Classic Vigenère
                let intermediate = vigenereCipher(inputText, key1, ALPHABET, false);
                
                // Second layer: Mapping encryption
                let output = vigenereCipher(intermediate, key2, SYMBOLS, false);
                
                // Add integrity check
                const integrityHash = simpleHash(inputText);
                output += '|' + integrityHash;
                
                document.getElementById('outputText').textContent = output;
                document.getElementById('verificationResult').textContent = 'Text encrypted successfully with integrity protection';
                document.getElementById('verificationResult').className = 'verification-result success';
            } catch (error) {
                document.getElementById('outputText').textContent = 'Error: ' + error.message;
                document.getElementById('verificationResult').textContent = 'Encryption failed';
                document.getElementById('verificationResult').className = 'verification-result error';
            }
        }
        
        // Decrypt text
        function decrypt() {
            if (!validateKeys()) return;
            
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            let inputText = document.getElementById('inputText').value;
            
            try {
                // Check for integrity hash
                let integrityHash = '';
                if (inputText.includes('|')) {
                    const parts = inputText.split('|');
                    inputText = parts[0];
                    integrityHash = parts[1];
                }
                
                // Second layer: Reverse mapping encryption
                let intermediate = vigenereCipher(inputText, key2, SYMBOLS, true);
                
                // First layer: Reverse classic Vigenère
                let output = vigenereCipher(intermediate, key1, ALPHABET, true);
                
                document.getElementById('outputText').textContent = output;
                
                // Verify integrity if hash was present
                if (integrityHash) {
                    const computedHash = simpleHash(output);
                    if (computedHash === integrityHash) {
                        document.getElementById('verificationResult').textContent = 'Integrity verified: No tampering detected';
                        document.getElementById('verificationResult').className = 'verification-result success';
                    } else {
                        document.getElementById('verificationResult').textContent = 'WARNING: Integrity check failed - text may have been modified';
                        document.getElementById('verificationResult').className = 'verification-result error';
                    }
                } else {
                    document.getElementById('verificationResult').textContent = 'No integrity information available';
                    document.getElementById('verificationResult').className = 'verification-result';
                }
            } catch (error) {
                document.getElementById('outputText').textContent = 'Error: ' + error.message;
                document.getElementById('verificationResult').textContent = 'Decryption failed';
                document.getElementById('verificationResult').className = 'verification-result error';
            }
        }
        
        // Vigenère cipher implementation
        function vigenereCipher(text, key, characterSet, decrypt) {
            let output = '';
            let keyIndex = 0;
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const keyChar = key[keyIndex % key.length];
                
                const charIndex = characterSet.indexOf(char);
                if (charIndex === -1) {
                    // Character not in set - leave as is
                    output += char;
                    continue;
                }
                
                const keyIndexPos = characterSet.indexOf(keyChar);
                if (keyIndexPos === -1) {
                    throw new Error('Key contains invalid characters for the character set');
                }
                
                let newIndex;
                if (decrypt) {
                    newIndex = (charIndex - keyIndexPos + characterSet.length) % characterSet.length;
                } else {
                    newIndex = (charIndex + keyIndexPos) % characterSet.length;
                }
                
                output += characterSet[newIndex];
                keyIndex++;
            }
            
            return output;
        }
        
        // Simple integrity hash
        function simpleHash(text) {
            let hash = 0;
            for (let i = 0; i < text.length; i++) {
                hash = ((hash << 5) - hash) + text.charCodeAt(i);
                hash |= 0; // Convert to 32-bit integer
            }
            return Math.abs(hash).toString(36).toUpperCase();
        }
        
        // Test encryption/decryption integrity
        function testIntegrity() {
            const originalText = document.getElementById('inputText').value;
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            
            if (!originalText || !key1 || !key2) {
                document.getElementById('verificationResult').textContent = 'Please enter text and both keys first';
                document.getElementById('verificationResult').className = 'verification-result error';
                return;
            }
            
            try {
                // Encrypt
                let encrypted = vigenereCipher(originalText.toUpperCase(), key1, ALPHABET, false);
                encrypted = vigenereCipher(encrypted, key2, SYMBOLS, false);
                
                // Decrypt
                let decrypted = vigenereCipher(encrypted, key2, SYMBOLS, true);
                decrypted = vigenereCipher(decrypted, key1, ALPHABET, true);
                
                // Verify
                if (decrypted === originalText.toUpperCase()) {
                    document.getElementById('verificationResult').textContent = 'Integrity test passed: Encryption/decryption cycle successful';
                    document.getElementById('verificationResult').className = 'verification-result success';
                } else {
                    document.getElementById('verificationResult').textContent = 'Integrity test failed: Output does not match input';
                    document.getElementById('verificationResult').className = 'verification-result error';
                }
            } catch (error) {
                document.getElementById('verificationResult').textContent = 'Integrity test error: ' + error.message;
                document.getElementById('verificationResult').className = 'verification-result error';
            }
        }
        
        // Reset all fields
        function resetAll() {
            document.getElementById('key1').value = 'SECRETKEYONE';
            document.getElementById('key2').value = 'SECRETKEYTWO';
            document.getElementById('inputText').value = 'Confidential data: Operation Midnight at 23:59';
            document.getElementById('outputText').textContent = 'Your encrypted/decrypted text will appear here';
            document.getElementById('verificationResult').textContent = 'No verification performed yet';
            document.getElementById('verificationResult').className = 'verification-result';
            validateKeys();
            updateSecurityStats();
        }
    </script>
</body>
</html>
