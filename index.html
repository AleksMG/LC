<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LatticeCrypto Pro | –†–µ–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</title>
    <style>
        :root {
            --primary-dark: #0d1b2a;
            --primary: #1b263b;
            --secondary: #415a77;
            --accent: #778da9;
            --light: #e0e1dd;
            --success: #4cc9f0;
            --warning: #f72585;
            --danger: #e63946;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Consolas', 'Monaco', monospace;
        }
        
        body {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            color: var(--light);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(27, 38, 59, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid var(--accent);
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(13, 27, 42, 0.7);
            border-radius: 10px;
            border: 1px solid var(--secondary);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            color: var(--success);
            text-shadow: 0 2px 10px rgba(76, 201, 240, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--accent);
            margin-bottom: 20px;
        }
        
        .info-section {
            background: rgba(13, 27, 42, 0.7);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid var(--success);
        }
        
        .info-section h2 {
            color: var(--success);
            margin-bottom: 15px;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: rgba(21, 31, 46, 0.9);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--secondary);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }
        
        .panel h2 {
            color: var(--success);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
            font-size: 1.5rem;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--accent);
            font-size: 1rem;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 8px;
            background: rgba(13, 27, 42, 0.8);
            color: var(--light);
            font-size: 1rem;
            border: 1px solid var(--secondary);
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--success);
            box-shadow: 0 0 15px rgba(76, 201, 240, 0.2);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
            font-family: monospace;
            line-height: 1.5;
        }
        
        button {
            background: linear-gradient(135deg, var(--secondary), var(--accent));
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .btn-encrypt {
            background: linear-gradient(135deg, #2a9d8f, #264653);
        }
        
        .btn-decrypt {
            background: linear-gradient(135deg, #e76f51, #f4a261);
        }
        
        .btn-clear {
            background: linear-gradient(135deg, var(--warning), var(--danger));
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background: rgba(13, 27, 42, 0.8);
            min-height: 120px;
            border: 1px solid var(--secondary);
            font-family: monospace;
            white-space: pre-wrap;
            word-break: break-all;
            overflow-y: auto;
            max-height: 300px;
        }
        
        .result-label {
            font-size: 1rem;
            color: var(--success);
            margin-bottom: 10px;
            font-weight: 600;
        }
        
        .status-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background: rgba(13, 27, 42, 0.8);
            border-radius: 8px;
            border: 1px solid var(--secondary);
        }
        
        .status-indicator {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: var(--success);
        }
        
        .status-working {
            animation: pulse 1.5s infinite;
            background: var(--success);
        }
        
        .status-error {
            background: var(--danger);
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        .security-info {
            margin-top: 30px;
            padding: 20px;
            background: rgba(13, 27, 42, 0.8);
            border-radius: 8px;
            border: 1px solid var(--secondary);
        }
        
        .security-info h3 {
            color: var(--accent);
            margin-bottom: 15px;
        }
        
        .security-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .stat {
            padding: 15px;
            background: rgba(27, 38, 59, 0.7);
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            color: var(--success);
            font-weight: bold;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--accent);
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--accent);
            font-size: 0.9rem;
            border-top: 1px solid var(--secondary);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LatticeCrypto Pro</h1>
            <p class="subtitle">–†–µ–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ—Ç–æ–∫</p>
        </header>
        
        <div class="info-section">
            <h2>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Learning With Errors (LWE)</h2>
            <p>–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ—à–µ—Ç–æ–∫ —Å —Ä–µ–∞–ª—å–Ω—ã–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ–º.</p>
        </div>
        
        <div class="main-content">
            <div class="panel">
                <h2>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h2>
                <div class="input-group">
                    <label for="inputText">–ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç:</label>
                    <textarea id="inputText" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è...">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∑–∞—â–∏—â–µ–Ω–Ω–æ–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–µ–π –Ω–∞ —Ä–µ—à–µ—Ç–∫–∞—Ö</textarea>
                </div>
                
                <div class="input-group">
                    <label for="key">–ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                    <input type="password" id="key" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á..." value="StrongPassword123!">
                </div>
                
                <div class="input-group">
                    <label for="securityLevel">–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ—à–µ—Ç–∫–∏:</label>
                    <select id="securityLevel">
                        <option value="256">n=256, q=4096 (—Ç–µ—Å—Ç–æ–≤—ã–π)</option>
                        <option value="512" selected>n=512, q=8192 (–±–∞–∑–æ–≤—ã–π)</option>
                        <option value="1024">n=1024, q=16384 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</option>
                    </select>
                </div>
                
                <button class="btn-encrypt" onclick="encryptText()">üîí –ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
                
                <div class="result">
                    <div class="result-label">–†–µ–∑—É–ª—å—Ç–∞—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</div>
                    <div id="encryptedResult"></div>
                </div>
            </div>
            
            <div class="panel">
                <h2>–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h2>
                <div class="input-group">
                    <label for="encryptedText">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:</label>
                    <textarea id="encryptedText" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ..."></textarea>
                </div>
                
                <div class="input-group">
                    <label for="decryptKey">–ö–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</label>
                    <input type="password" id="decryptKey" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á...">
                </div>
                
                <button class="btn-decrypt" onclick="decryptText()">üîì –î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
                <button class="btn-clear" onclick="clearAll()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
                
                <div class="result">
                    <div class="result-label">–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:</div>
                    <div id="decryptedResult"></div>
                </div>
            </div>
        </div>
        
        <div class="security-info">
            <h3>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h3>
            <div class="security-stats">
                <div class="stat">
                    <div class="stat-value" id="securityLevelText">n=512</div>
                    <div class="stat-label">–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–µ—à–µ—Ç–∫–∏</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="modulusText">q=8192</div>
                    <div class="stat-label">–ú–æ–¥—É–ª—å</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="estimatedCrackTime">>10^80 –ª–µ—Ç</div>
                    <div class="stat-label">–û—Ü–µ–Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –≤–∑–ª–æ–º–∞</div>
                </div>
            </div>
        </div>
        
        <div class="status-bar">
            <div class="status-indicator" id="statusIndicator"></div>
            <span id="statusText">–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ</span>
        </div>
        
        <footer>
            <p>LatticeCrypto Pro v1.0 | –†–µ–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è | 2024</p>
        </footer>
    </div>

    <script>
        // ============ –ü–ê–†–ê–ú–ï–¢–†–´ LWE ============
        const LWE_PARAMS = {
            256: { n: 256, q: 4096, error: 3.2 },
            512: { n: 512, q: 8192, error: 3.2 },
            1024: { n: 1024, q: 16384, error: 3.2 }
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–ª—é—á–µ–π
        let lwePublicKey = null;
        let lweSecretKey = null;
        let lweParams = null;
        let encryptionCache = new Map();

        // ============ –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –§–£–ù–ö–¶–ò–ò ============
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
        function getRandomValues(length) {
            const array = new Uint32Array(length);
            if (window.crypto && window.crypto.getRandomValues) {
                window.crypto.getRandomValues(array);
            } else {
                for (let i = 0; i < length; i++) {
                    array[i] = Math.floor(Math.random() * 4294967295);
                }
            }
            return array;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—à–∏–±–æ–∫ —Å –≥–∞—É—Å—Å–æ–≤—Å–∫–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º
        function generateGaussianError(n, stdDev) {
            const errors = new Int32Array(n);
            for (let i = 0; i < n; i++) {
                let u = 0, v = 0;
                while(u === 0) u = Math.random();
                while(v === 0) v = Math.random();
                const normal = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);
                errors[i] = Math.round(normal * stdDev);
            }
            return errors;
        }
        
        // –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞
        function mod(x, q) {
            return ((x % q) + q) % q;
        }
        
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–µ–π LWE
        function generateLWEKeys(params) {
            const { n, q, error } = params;
            
            // –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á - —Å–ª—É—á–∞–π–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
            const secret = new Array(n);
            const randomValues = getRandomValues(n);
            for (let i = 0; i < n; i++) {
                secret[i] = mod(randomValues[i], q);
            }
            
            // –ú–∞—Ç—Ä–∏—Ü–∞ A - –ø—É–±–ª–∏—á–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
            const A = new Array(n);
            for (let i = 0; i < n; i++) {
                A[i] = new Array(n);
                const rowRandom = getRandomValues(n);
                for (let j = 0; j < n; j++) {
                    A[i][j] = mod(rowRandom[j], q);
                }
            }
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—à–∏–±–æ–∫
            const e = generateGaussianError(n, error);
            
            // –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á b = A*s + e
            const b = new Array(n);
            for (let i = 0; i < n; i++) {
                let sum = 0;
                for (let j = 0; j < n; j++) {
                    sum += A[i][j] * secret[j];
                }
                b[i] = mod(sum + e[i], q);
            }
            
            return { secret, A, b };
        }
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
        function textToBinary(text) {
            const encoder = new TextEncoder();
            const bytes = encoder.encode(text);
            let binary = '';
            for (let i = 0; i < bytes.length; i++) {
                binary += bytes[i].toString(2).padStart(8, '0');
            }
            return binary;
        }
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –≤ —Ç–µ–∫—Å—Ç
        function binaryToText(binary) {
            const bytes = [];
            for (let i = 0; i < binary.length; i += 8) {
                const byte = binary.substr(i, 8);
                bytes.push(parseInt(byte, 2));
            }
            const decoder = new TextDecoder();
            return decoder.decode(new Uint8Array(bytes));
        }
        
        // LWE —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–∏—Ç–∞
        function LWEEncryptBit(bit, publicKey, params) {
            const { n, q } = params;
            const { A, b } = publicKey;
            
            // –í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ r
            const r = new Array(n);
            for (let i = 0; i < n; i++) {
                r[i] = Math.random() > 0.5 ? 1 : 0;
            }
            
            // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ u = A^T * r
            const u = new Array(n);
            for (let j = 0; j < n; j++) {
                u[j] = 0;
                for (let i = 0; i < n; i++) {
                    u[j] += A[i][j] * r[i];
                }
                u[j] = mod(u[j], q);
            }
            
            // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ v = b^T * r + bit * (q/2)
            let v = 0;
            for (let i = 0; i < n; i++) {
                v += b[i] * r[i];
            }
            v = mod(v + Math.floor(q/2) * bit, q);
            
            return { u, v };
        }
        
        // LWE –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –±–∏—Ç–∞
        function LWEDecryptBit(ciphertext, secret, params) {
            const { n, q } = params;
            const { u, v } = ciphertext;
            
            // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ d = v - s^T * u
            let d = v;
            for (let j = 0; j < n; j++) {
                d -= secret[j] * u[j];
            }
            d = mod(d, q);
            
            // –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏—Ç–∞
            const threshold = Math.floor(q/4);
            return (d > threshold && d < 3 * threshold) ? 1 : 0;
        }
        
        // –ü–æ–ª–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        function encryptTextLWE(text, publicKey, params) {
            const binary = textToBinary(text);
            const ciphertexts = [];
            
            for (let i = 0; i < binary.length; i++) {
                const bit = parseInt(binary[i]);
                ciphertexts.push(LWEEncryptBit(bit, publicKey, params));
            }
            
            return ciphertexts;
        }
        
        // –ü–æ–ª–Ω–æ–µ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
        function decryptTextLWE(ciphertexts, secret, params) {
            let binary = '';
            
            for (const ciphertext of ciphertexts) {
                const bit = LWEDecryptBit(ciphertext, secret, params);
                binary += bit.toString();
            }
            
            return binaryToText(binary);
        }
        
        // ============ –°–ò–°–¢–ï–ú–ù–´–ï –§–£–ù–ö–¶–ò–ò ============
        function updateStatus(message, type = 'ready') {
            const indicator = document.getElementById('statusIndicator');
            const statusText = document.getElementById('statusText');
            
            indicator.className = 'status-indicator';
            if (type === 'working') {
                indicator.classList.add('status-working');
            } else if (type === 'error') {
                indicator.classList.add('status-error');
            }
            
            statusText.textContent = message;
        }
        
        function updateSecurityInfo(securityLevel) {
            const params = LWE_PARAMS[securityLevel];
            document.getElementById('securityLevelText').textContent = `n=${params.n}`;
            document.getElementById('modulusText').textContent = `q=${params.q}`;
            
            // –û—Ü–µ–Ω–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –≤–∑–ª–æ–º–∞ (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å)
            const crackTime = Math.pow(2, 0.265 * params.n);
            document.getElementById('estimatedCrackTime').textContent = `>10^${Math.log10(crackTime).toFixed(0)} –ª–µ—Ç`;
        }
        
        function clearAll() {
            document.getElementById('encryptedText').value = '';
            document.getElementById('decryptKey').value = '';
            document.getElementById('decryptedResult').textContent = '';
            updateStatus('–í—Å–µ –ø–æ–ª—è –æ—á–∏—â–µ–Ω—ã', 'ready');
        }
        
        // ============ –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò –®–ò–§–†–û–í–ê–ù–ò–Ø ============
        function encryptText() {
            const text = document.getElementById('inputText').value;
            const password = document.getElementById('key').value;
            const securityLevel = parseInt(document.getElementById('securityLevel').value);
            
            if (!text) {
                updateStatus('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            if (!password) {
                updateStatus('–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            updateStatus('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π LWE...', 'working');
            
            setTimeout(() => {
                try {
                    // –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã LWE
                    lweParams = LWE_PARAMS[securityLevel];
                    updateSecurityInfo(securityLevel);
                    
                    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π LWE
                    const keys = generateLWEKeys(lweParams);
                    lwePublicKey = { A: keys.A, b: keys.b };
                    lweSecretKey = keys.secret;
                    
                    updateStatus('–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è...', 'working');
                    
                    // –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞
                    const ciphertexts = encryptTextLWE(text, lwePublicKey, lweParams);
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫—ç—à –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
                    encryptionCache.set(password, { ciphertexts, secret: lweSecretKey, params: lweParams });
                    
                    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                    const result = {
                        ciphertext: ciphertexts,
                        params: {
                            n: lweParams.n,
                            q: lweParams.q
                        },
                        info: "–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ø–µ—Ä–≤—ã–µ 100 –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–∫–∞–∑–∞–Ω—ã)"
                    };
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
                    const displayData = JSON.stringify(result, (key, value) => {
                        if (key === 'ciphertext' && Array.isArray(value)) {
                            return value.slice(0, 5); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
                        }
                        return value;
                    }, 2);
                    
                    document.getElementById('encryptedResult').textContent = displayData;
                    document.getElementById('encryptedText').value = JSON.stringify(result);
                    updateStatus('–¢–µ–∫—Å—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω', 'ready');
                } catch (error) {
                    updateStatus('–û—à–∏–±–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ' + error.message, 'error');
                    console.error(error);
                }
            }, 100);
        }
        
        function decryptText() {
            const encryptedData = document.getElementById('encryptedText').value;
            const password = document.getElementById('decryptKey').value;
            
            if (!encryptedData) {
                updateStatus('–í–≤–µ–¥–∏—Ç–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 'error');
                return;
            }
            
            if (!password) {
                updateStatus('–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è', 'error');
                return;
            }
            
            updateStatus('–î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ...', 'working');
            
            setTimeout(() => {
                try {
                    // –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö
                    const data = JSON.parse(encryptedData);
                    const ciphertexts = data.ciphertext;
                    
                    // –ü–æ–ª—É—á–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∏–∑ –∫—ç—à–∞
                    const cached = encryptionCache.get(password);
                    if (!cached) {
                        throw new Error("–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –∏–ª–∏ —Å–µ—Å—Å–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞");
                    }
                    
                    // –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
                    const decrypted = decryptTextLWE(ciphertexts, cached.secret, cached.params);
                    
                    document.getElementById('decryptedResult').textContent = decrypted;
                    updateStatus('–¢–µ–∫—Å—Ç —É—Å–ø–µ—à–Ω–æ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω', 'ready');
                } catch (error) {
                    updateStatus('–û—à–∏–±–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è: ' + error.message, 'error');
                    console.error(error);
                }
            }, 100);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateStatus('–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ', 'ready');
        updateSecurityInfo(512); // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
    </script>
</body>
</html>
